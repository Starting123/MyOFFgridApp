# ЁЯФз р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╕Ыр╕▒р╕Нр╕лр╕▓: р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕лр╕▓р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕нр╕╖р╣Ир╕Щр╣Др╕бр╣Ир╣Ар╕Ир╕н (Complete Troubleshooting Guide)

## тЬЕ р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Йр╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕╡р╣Ир╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╣Бр╕ер╣Йр╕з

### 1. р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Android Permissions

р╣Др╕Яр╕ер╣М `android/app/src/main/AndroidManifest.xml` р╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╣Бр╕ер╣Йр╕зр╣Гр╕лр╣Йр╕гр╕нр╕Зр╕гр╕▒р╕Ъ:
- тЬЕ Bluetooth permissions (Android 12+)
- тЬЕ WiFi Direct permissions
- тЬЕ Nearby WiFi Devices permission (Android 13+)
- тЬЕ Location permissions
- тЬЕ Network security config

### 2. р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕З NearbyService

р╣Др╕Яр╕ер╣М `lib/src/services/nearby_service.dart` р╕бр╕╡р╕Бр╕▓р╕гр╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕З:
- тЬЕ Debug logs р╕Чр╕╡р╣Ир╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Вр╕╢р╣Йр╕Щ (р╕ар╕▓р╕йр╕▓р╣Др╕Чр╕в)
- тЬЕ Permission checking р╕Чр╕╡р╣Ир╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щ
- тЬЕ Error handling р╕Чр╕╡р╣Ир╕Фр╕╡р╕Вр╕╢р╣Йр╕Щ
- тЬЕ Connection status monitoring

### 3. р╣Ар╕Юр╕┤р╣Ир╕б Debug Helper

р╣Др╕Яр╕ер╣Мр╣Гр╕лр╕бр╣И `lib/src/utils/debug_helper.dart`:
- тЬЕ р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ permissions р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
- тЬЕ р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣М
- тЬЕ р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╕Ыр╕▒р╕Нр╕лр╕▓

### 4. р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕З UI р╣Бр╕ер╕░ UX

р╕лр╕Щр╣Йр╕▓ Device List Screen:
- тЬЕ р╕Ыр╕╕р╣Ир╕б Debug Info (тЪб)
- тЬЕ р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Бр╕Бр╣Йр╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕╡р╣Ир╕Кр╕▒р╕Фр╣Ар╕Ир╕Щ
- тЬЕ Status indicators р╕Чр╕╡р╣Ир╕Фр╕╡р╕Вр╕╢р╣Йр╕Щ

## ЁЯЪА р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ър╣Гр╕лр╕бр╣И

### р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕З 1 (SOS Device):
```
1. Build р╣Бр╕ер╕░ install р╣Бр╕нр╕Ы: flutter build apk --debug
2. Install: adb install build/app/outputs/flutter-apk/app-debug.apk
3. р╣Ар╕Ыр╕┤р╕Фр╣Бр╕нр╕Ы тЖТ Settings
4. р╕Бр╕гр╕нр╕Б Name: "SOS_Test_1"
5. р╣Ар╕ер╕╖р╕нр╕Б Device Type: "ЁЯЖШ SOS - р╕Ьр╕╣р╣Йр╕Ыр╕гр╕░р╕кр╕Ър╕ар╕▒р╕в"
6. р╕Бр╕Ф Save
7. р╕Бр╕ер╕▒р╕Ър╕лр╕Щр╣Йр╕▓р╕лр╕ер╕▒р╕Б
8. р╕Бр╕Ф SOS button (р╕Ыр╕╕р╣Ир╕бр╣Бр╕Фр╕Зр╣Гр╕лр╕Нр╣И)
9. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ debug logs р╕Хр╣Йр╕нр╕Зр╣Ар╕лр╣Зр╕Щ:
   ЁЯУб р╣Ар╕гр╕┤р╣Ир╕б advertising: SOS_Test_1
   тЬЕ р╣Ар╕гр╕┤р╣Ир╕б advertising р╕кр╕│р╣Ар╕гр╣Зр╕И
```

### р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕З 2 (Rescuer Device):
```
1. Install р╣Бр╕нр╕Ы (р╣Ар╕лр╕бр╕╖р╕нр╕Щр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕З 1)
2. р╣Ар╕Ыр╕┤р╕Фр╣Бр╕нр╕Ы тЖТ Settings
3. р╕Бр╕гр╕нр╕Б Name: "Rescuer_Test_1"
4. р╣Ар╕ер╕╖р╕нр╕Б Device Type: "ЁЯСитАНтЪХя╕П Rescuer - р╕Щр╕▒р╕Бр╕Бр╕╣р╣Йр╕ар╕▒р╕в"
5. р╕Бр╕Ф Save
6. р╕Бр╕ер╕▒р╕Ър╕лр╕Щр╣Йр╕▓р╕лр╕ер╕▒р╕Б
7. р╣Ар╕Ыр╕┤р╕Ф Rescuer Mode (р╕кр╕зр╕┤р╕Хр╕Кр╣Мр╕кр╕╡р╕Щр╣Йр╕│р╣Ар╕Зр╕┤р╕Щ)
8. р╕Бр╕Ф Devices button (р╣Др╕нр╕Др╕нр╕Щ ЁЯУ▒)
9. р╕Бр╕Ф Scan button
10. р╕гр╕н 30 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡
11. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ debug logs р╕Хр╣Йр╕нр╕Зр╣Ар╕лр╣Зр╕Щ:
    ЁЯФН р╣Ар╕гр╕┤р╣Ир╕бр╕кр╣Бр╕Бр╕Щр╕лр╕▓р╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣Мр╣Гр╕Бр╕ер╣Йр╣Ар╕Др╕╡р╕вр╕З...
    ЁЯОп р╕Юр╕Ър╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣М: endpoint_xxx
    ЁЯдЭ р╕бр╕╡р╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╣Ар╕Вр╣Йр╕▓р╕бр╕▓
    тЬЕ р╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕кр╕│р╣Ар╕гр╣Зр╕И
```

## ЁЯФН р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Debug Logs

### р╣Гр╕Щ VS Code/Android Studio:
```bash
flutter logs
```

### р╕лр╕гр╕╖р╕н р╕Ьр╣Ир╕▓р╕Щ ADB:
```bash
adb logcat | grep -E "(ЁЯЖШ|ЁЯУб|ЁЯФН|тЬЕ|тЭМ)"
```

### Logs р╕Чр╕╡р╣Ир╕Др╕зр╕гр╣Ар╕лр╣Зр╕Щ (SOS Device):
```
ЁЯЖШ р╣Ар╕Ыр╕┤р╕Ф SOS Mode...
ЁЯФД р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ services...
P2P Service: тЬЕ
Nearby Service: тЬЕ
ЁЯУб р╣Ар╕гр╕┤р╣Ир╕б advertising: SOS_Test_1
тЬЕ р╣Ар╕гр╕┤р╣Ир╕б advertising р╕кр╕│р╣Ар╕гр╣Зр╕И: SOS_Test_1
```

### Logs р╕Чр╕╡р╣Ир╕Др╕зр╕гр╣Ар╕лр╣Зр╕Щ (Rescuer Device):
```
ЁЯСитАНтЪХя╕П р╣Ар╕Ыр╕┤р╕Ф Rescuer Mode...
ЁЯФН р╣Ар╕гр╕┤р╣Ир╕бр╕кр╣Бр╕Бр╕Щр╕лр╕▓ SOS signals...
тЬЕ р╣Ар╕гр╕┤р╣Ир╕бр╕кр╣Бр╕Бр╕Щр╕кр╕│р╣Ар╕гр╣Зр╕И
ЁЯОп р╕Юр╕Ър╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣М: endpoint_12345
   Name: SOS_Test_1
ЁЯдЭ р╕бр╕╡р╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╣Ар╕Вр╣Йр╕▓р╕бр╕▓: endpoint_12345
тЬЕ р╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕кр╕│р╣Ар╕гр╣Зр╕И: endpoint_12345
```

## тЪая╕П р╕лр╕▓р╕Б Debug Logs р╣Др╕бр╣Ир╣Бр╕кр╕Фр╕Зр╕Ьр╕е

### 1. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Permissions:
```
Settings > Apps > Off-Grid SOS > Permissions
тЬЕ Location: "Allow all the time"
тЬЕ Bluetooth: "Allow" 
тЬЕ Nearby devices: "Allow"
тЬЕ Camera: "Allow"
тЬЕ Files and media: "Allow"
```

### 2. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕гр╕░р╕Ър╕Ъ:
```
Android Settings:
тЬЕ Bluetooth: ON
тЬЕ Location/GPS: ON  
тЬЕ WiFi: ON (р╕лр╕гр╕╖р╕н OFF р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Чр╕Фр╕кр╕нр╕Ъ offline)
тЬЕ Mobile Data: OFF (р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Чр╕Фр╕кр╕нр╕Ъ offline)
```

### 3. Reset р╣Бр╕ер╕░р╕Чр╕Фр╕кр╕нр╕Ър╣Гр╕лр╕бр╣И:
```bash
# Clear app data
adb shell pm clear com.example.offgrid_sos

# Reinstall
adb install -r build/app/outputs/flutter-apk/app-debug.apk

# Restart devices
adb reboot
```

## ЁЯЫая╕П р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕н Debug р╣Гр╕лр╕бр╣И

### р╣Гр╕Щ Device List Screen:
- р╕Бр╕Фр╕Ыр╕╕р╣Ир╕б тЪб (Debug Info) р╣Ар╕Юр╕╖р╣Ир╕нр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ permissions
- р╕Фр╕╣р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Бр╕Щр╕░р╕Щр╕│р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╕Ыр╕▒р╕Нр╕лр╕▓
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ debug console

### р╕Др╕│р╕кр╕▒р╣Ир╕З Build р╣Гр╕лр╕бр╣И:
```bash
# Windows
.\build_and_deploy.ps1

# Linux/Mac  
./build_and_deploy.sh
```

## ЁЯУЛ Checklist р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ

### р╕Бр╣Ир╕нр╕Щр╕Чр╕Фр╕кр╕нр╕Ъ:
- [ ] Build р╣Бр╕нр╕Ыр╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щр╕ер╣Ир╕▓р╕кр╕╕р╕Ф
- [ ] Install р╣Гр╕Щр╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣Мр╕Чр╕▒р╣Йр╕Зр╕кр╕нр╕З
- [ ] р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ permissions р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
- [ ] р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ device names р╣Бр╕ер╕░ types
- [ ] р╕зр╕▓р╕Зр╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣Мр╕лр╣Ир╕▓р╕Зр╕Бр╕▒р╕Щ 1-5 р╣Ар╕бр╕Хр╕г

### р╕гр╕░р╕лр╕зр╣Ир╕▓р╕Зр╕Чр╕Фр╕кр╕нр╕Ъ:
- [ ] р╣Ар╕Ыр╕┤р╕Ф SOS р╕Бр╣Ир╕нр╕Щ (р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕З 1)
- [ ] р╕гр╕н 10 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡
- [ ] р╣Ар╕Ыр╕┤р╕Ф Rescuer mode (р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕З 2)
- [ ] р╣Ар╕Ыр╕┤р╕Ф Device List р╣Бр╕ер╕░ Scan
- [ ] р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ debug logs
- [ ] р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ UI updates

### р╕лр╕▓р╕Бр╕вр╕▒р╕Зр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕Ьр╕е:
- [ ] р╕ер╕нр╕З emulator + real device
- [ ] р╕ер╕нр╕Зр╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣Мр╕вр╕╡р╣Ир╕лр╣Йр╕нр╣Ар╕Фр╕╡р╕вр╕зр╕Бр╕▒р╕Щ
- [ ] р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Android version (API 21+)
- [ ] р╕Фр╕╣ `TROUBLESHOOTING.md` р╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б

## ЁЯУЮ Support

р╕лр╕▓р╕Бр╕вр╕▒р╕Зр╕бр╕╡р╕Ыр╕▒р╕Нр╕лр╕▓:
1. р╕кр╣Ир╕З debug logs р╕Ир╕▓р╕Б `flutter logs`
2. р╕гр╕░р╕Ър╕╕ Android version р╣Бр╕ер╕░р╕гр╕╕р╣Ир╕Щр╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣М
3. р╕гр╕░р╕Ър╕╕р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣Ир╕Чр╕│ р╣Бр╕ер╕░ expected vs actual results

---
**р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕:** р╕Бр╕▓р╕гр╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╕Др╕гр╕▒р╣Йр╕Зр╕Щр╕╡р╣Йр╣Ар╕Юр╕┤р╣Ир╕б debug capabilities р╣Бр╕ер╕░р╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓ permissions р╕Чр╕╡р╣Ир╕Юр╕Ър╕Ър╣Ир╕нр╕в р╣Гр╕Щр╕Бр╕гр╕Ур╕╡р╕Чр╕╡р╣Ир╕вр╕▒р╕Зр╕бр╕╡р╕Ыр╕▒р╕Нр╕лр╕▓ р╣Гр╕лр╣Йр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ debug logs р╣Ар╕Ыр╣Зр╕Щр╕нр╕▒р╕Щр╕Фр╕▒р╕Ър╣Бр╕гр╕Б